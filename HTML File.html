<!DOCTYPE html>
<html lang="en">
<head>
     <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <!-- Test Remote -->
    <!-- Test Local -->

    <meta charset="UTF-8">
    <title>Count Down To Freedom</title>
    <style>
        header {
            background-color: #ad89cc;
            color: #352047;
            padding: 30px;
            text-align: center;
            font-size: 35px;
            margin-bottom: 20px;
        }
        footer {
            background-color: #ad89cc;
            color: #352047;
            margin-top: 20px;
            padding: 10px;
            text-align: center;
        }
        .bigger-container{
            display: inline-block;
            margin: auto;
        }    
        .big-container{
            background-color:#e7d7f4;
            color:#572782;
            display: flex;
            justify-content: center;
            align-items: center;
            align-self: center;
            background-color:#e7d7f4;
            border-radius: 50px;
            box-shadow: 10px 5px 5px #ad89cc;
            color:#572782;
            display: flex;
            font-family:Georgia, serif;
            font-size: 75px;
            justify-content: center;
            margin-bottom: 20px;
            margin-top: 20px;

            height: 25%;
            width: 75%;

        }

        .big-container-w-inner{
            align-items:center;
            align-self: center;
            background-color:#e7d7f4;
            border-radius: 50px;
            box-shadow: 10px 5px 5px #ad89cc;
            color:#572782;
            /*display: grid;*/
            font-family:Georgia, serif;
            font-size: 35px;
            justify-content: center;
            margin-top: 20px;
            margin-bottom: 20px;
            padding-top: 4px;
            padding-bottom: 4px;

            width: 75%;

        }


        .mini-container{
            width: 80%;
            height: 80%;
            background-color:#ad89cc;
            color:#352047;
            align-items:center;
            justify-content:center;
            display:flex;
            font-size:20px;
            border-radius:50px;
            margin:10px;
            margin-left: auto;
            margin-right:auto;
            overflow: start;


        }

        body, html{
            height: 100%;
            justify-items:center;
        }

        p {
            margin: 6%;
            font-size: 40px;
            
        }

       
        
    </style>
</head>
<body>
    
    
    <header> <h1> Days until Summer Break! </h1></header>
    <center> <!--Leave us alone, it'll go away later (maybe)-->

        <div class="big-container">
            <p  style="font-size:100px" id="weekdaysLeft"></p>
        </div>

        <br>
    <div id="important-dates" class="big-container-w-inner"></div>

        <!--Can't get them to stack >:(    -->
    <!--Stretchy---->
<br>
    <footer> Made by Zeph Burek and Arlo Russell </footer>
    <script >
        let startDate, endDate;
        let dateData;
        const importantDatesDiv = document.getElementById("important-dates");
        //Pulls dates from a cq
        fetch("https://ects-cmp.com/files/calendar.json")
        .then(resp => resp.json())
        .then(data => {
                processDateFile(data);               
        })
        //Write start date and end date when you can think again
        // (For some reason, this [BEEP] mostly got deleted and [BEEP]-ed with???)
        function processDateFile(data){
            printThings(data);
            dateData = data;

            
            //get the current date (it will be a date object)
            var today = new Date();
            var dd = String(today.getDate());
            var mm = String(today.getMonth() + 1);
            var yyyy = today.getFullYear();
            var todaystr = mm + '/' + dd + '/' + yyyy;
           // document.getElementById("today").innerHTML = today;                      
            //print out how many days from now until then
            endDate = data.endday;
            startDate = data.startday;

            //convert the enddate to a date object  
            //subtract all days listed as events after today from the weekdaysLeft 
            var weekdaysCount = getWeekdayCount(today, endDate);
          //  document.getElementById("weekdaysCount").innerHTML = weekdaysCount;
            var daysOffCount = getDaysOffLeft(today, endDate);


            var weekdaysLeft = weekdaysCount - daysOffCount;
            document.getElementById("weekdaysLeft").innerHTML = weekdaysLeft;
           // document.getElementById("enddate").innerHTML = endDate; //haha...
            

        }

        function getWeekdayCount() {
            let count = 0;
            const currentDate = new Date();
            const endDateObj = new Date(endDate);
            console.log(currentDate);
            console.log(endDate);
            while (currentDate <= endDateObj) {
                
                const dayOfWeek = currentDate.getDay();
                    if (dayOfWeek !== 0 && dayOfWeek !== 6) {
                        count++;
                    }
                currentDate.setDate(currentDate.getDate() + 1);
            }   
            return count;
        }
            
        function getDaysOffLeft(){
            let count = 0;
            importantDatesDiv.innerHTML = "";
            const currentDate = new Date();
            for(let i = 0; i<dateData.events.length; i++){ 
                for(let j = 0; j<dateData.events[i].days.length; j++){
                    let dayOffDate = new Date(dateData.events[i].days[j])
                    if( dayOffDate> currentDate){
                        count ++;
                        importantDatesDiv.innerHTML += `
                        <div class="mini-container">
                            <p class="eventitem"> ${dateData.events[i].event} : ${dateData.events[i].days[j]} </p>
                        </div>
                        `;
                    }
                }
            }
            return count;
        }


        function printThings(data){
            console.log(data);
            for(let i = 0; i<data.events.length; i++){ 
                console.log(data.events[i].event); 
                    for(let j = 0; j<data.events[i].days.length; j++){
                        console.log(data.events[i].days[j]);
                    }
            }
            
   
            console.log(data.events[0]);//the whole first event object
            console.log(data.events[0].event);//the event description
            console.log(data.events[0].days);//the days associated with the event
            console.log(data.events[0].days[0]);//the first associated day of the event
        }
    </script>
</body>
</html>
<!--Html Notes:-->
<!--Border-radius is the rounded corners.-->
<!--align-items: center puts them at the center top to bottom-->
<!--justify-content puts them in the center side to side-->
<!--Appearantly height doesn't apply when the boxes are centered-->

<!--Note Key-->
<!--Arlo-->
<!--(Zeph)-->

<!--I don't know what's going on with the width for the mini boxes, they're killing me inside and I hate them...but they're pretty.-->
<!--I put an align enter in the body css. I can't check it tho-->
<!--I have no idea how to center align everything and I'm very annoyed so you're now going to have drop shadows-->
<!--And now I shall order our CSS in alphabetical order.-->

<!-- (JavaScript will be the death of me) -->
<!-- (But I think I actually know what I'm doing!)-->
<!-- (I am also calm now, but maybe it's because I am distracted)-->
<!-- (I lied, no longer knowing what Im doing) -->

<!--I have no idea what magic you pulled to get the start date/end date to work lol-->
<!--Have no idea what to do rn. Might go work on TH-->

<!-- (I am going to marry chatGPT when I grow up)-->

<!--Stupid text boses not holding the infor I need them to.-->
<!--How did I write that so bad????? What????-->
<!--I have no idea what happened to the enddate. I might drag Klins to figure it out-->
<!--*Confused Screaming*-->
<!--OMG THE BORDERS WERE IN % IM GOING TO DIE AAAAAAHHHHHHHHh-->